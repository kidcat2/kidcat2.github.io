---
title: "컴퓨터 네트워크 #19"
date: 2023-8-01 +0000
categories: [Major, Computer Network]
tags: [컴퓨터 네트워크, Computer Network]
math: true
published : true
---

---
## 목차

1. 이동 IP
2. DHCP ( 동적 호스트 구성 프로토콜 )

---

### **이동 IP**

소형 컴퓨터 및 이동형 컴퓨터(스마트폰) 의 `대중화`로 인해, 하나의 인터넷 접속점에서 다른 접속점으로 이동하는 동안 **인터넷 연결을 유지하는 기술**이 필요했고, 이것이 바로 `이동IP(Mobile IP)`이다.

유선 인터넷의 경우 호스트의 **IP주소가 고정**되고 이 주소를 기반으로 경로를 선택하기 때문에, 호스트가 이동하면 IP주소 변경의 여부에 따라경로 선택에 영향이 간다.

1. **이동IP 의 필수사항**

    호스트 이동 시 전송되는 데이터들의 전송 경로는 새로운 위치로 변경된다.

    이동시 서비스가 끊기면 안된다.

    인터넷에서 IP프로토콜은 IP주소를 근거로 라우팅하는데, 이동IP 의 경우 IP주소의 처리에 대해 검토 해봐야 한다. 
    
    → IP가 이동했으면, 새로운 데이터는 `이동한IP`로 전송되어야 한다.

    <br>
​
2. **이동 IP 동작**

    하나의 `이동노드(mobile node)`가 `홈 네트워크(home network)` 라고 부르는 특정 네트워크에 배정되고, 그 네트워크 상에서 그 노드의 IP 주소를 고정시킨다. 
    
    이 주소를 `홈 주소`라고 부른다.

    이동노드가 접속점을 다른 네트워크로 이동하게 되면, 옮겨간 네트워크를 그 호스트의 `외부 네트워크(foregin network)`로 간주한다. 
    
    이동노드가 재접속되면, 외부 네트워크상에서 외부 에이전트 라고 알려진 네트워크 노드에 등록을 함으로써 자신의 존재를 알리고, 외부 에이전트는 홈 에이전트로 알려진 사용자의 홈 네트워크상에 있는 동류의 에이전트와 통신을 한다. 
    
    이 떄 이동노드의 `관심 주소(cafe-of-address)`를 홈 에이전트에 제공한다.

    [이동IP 용어들을 정리한 사진을 맨 아래에 추가하였다.](#이동-ip용어)

    데이터 전송은 다음과 같이 이루어진다.

    1. `서버X`에서 `이동노드A`로 `IP데이터그램`을 보내려고 한다.
    2. `서버X`는 IP헤더에 `A의 홈 주소`를 적어서 IP 데이터그램을 전송한다.
    3. 홈 네트워크에서 들어오는 IP 데이터그램이 `홈 에이전트`에 의해 가로채어 진다.
    4. 홈 에이전트는 IP 데이터그램을 `헤더에 A의 관심 주소를 가진 새로운 IP 데이터 그램`으로 `캡슐화` 한다.
    5. 이 때 다른 목적지 `IP주소`를 가지는 바깥쪽 IP 데이터그램을 사용하는 것을 `터널링` 이라고 한다.
    6. 이 IP데이터그램이 `외부 에이전트`로 보내진다.
    7. 외부 에이전트는 바깥쪽 IP헤더를 벗긴 후, 원래 IP데이터그램을 네트워크 수준으로 캡슐화 한다.
    8. 이 캡슐화 한 것을 `외부 네트워크`를 통해 A로 배달한다.

    <br>

### **DHCP(동적 호스트 구성 프로토콜 : Dynamic Host Configuratio Protocol)**

IP 주소가 부족해 짐에 따라, 네트워크 관리자는 개별 호스트에게 수동으로 고정 IP를 할당하는 것이 아니라 IP 주소의 동적할당을 하려고 했고, 이 기술이 `DHCP` 이다.

즉, 사용하지 않는 곳의 IP 주소를 할당하지 않고 사용하는 곳의 IP 주소를 자동으로 할당하는 기술이다. 

이는 앞으로 IP 헤더가 IPv6의 주소로 모두 교체되어 주소가 부족해지지 않을 때까지 사용될 것으로 보고 있다.

1. **DHCP 개요**

    자동으로 할당 가능한 IP주소는 DHCP서버가 관리하는 `풀`에 저장되어 관리된다.

    서버는 클라이언트로부터 IP주소 요청이 오면 풀에서 하나의 IP 주소를 할당한다.

    클라이언트에 사용이 끝나면, IP주소를 풀로 다시 반환받고, 필요한 다른 호스트가 생기면 다시 할당한다.

    <br>

2. **DHCP 메시지**

    1. **DHCP_DISCOVER(발견)**

        - 클라이언트가 DHCP 서버를 찾기 위해 전송하는 브로드캐스트 메시지

        `Transaction Identifer`에 특정한 값을 지정, 클라이언트는 아직 IP 주소값이 없으므로 송신자의 IP 주소를 `0.0.0.0` 으로 지정한다. 
        
        또한 클라이언트는 DHCP서버의 IP 주소를 모르므로 브로드캐스팅을 해야하고, 따라서 수신자 IP 주소에는 브로드캐스팅 주소인 `255.255.255.255` 를 지정한다.

        <br>

    2. **DHCP_OFFER(제안)**

        - 메시지에 대해 DHCP서버가 **응답**하는 메시지

        `Your IP Address` 필드에 권고하는 IP주소를 지정한다. `Server IP Address` 필드에는 서버의 IP 주소를 지정한다.

        이 응답을 보내는 순간까지는 클라이언트의 IP 주소가 결정되지 않았으므로 IP패킷은 브로드캐스팅 형식으로 전송된다.

        <br>

    3. **DHCP_REQUEST(응답)** 

        클라이언트는 여러 `DHCP 서버`로부터 `DHCP_OFFER` 를 받고, 이 중 하나의 IP 주소를 선택한다. 

        그리고 이 주소를 권고한 `DHCP 서버`에 `REQUEST 메시지`를 전송한다.

        <br>

    4. **DHCP_ACK : REQUEST**

        메시지를 받은 `DHCP 서버`는 권고한 IP 주소가 최종적으로 사용가능한지 판단해서 사용가능하면 `ACK 메시지`를 전송한다.

        <br>

    5. **DHCP_NACK**

        `DHCP 서버`는 동일한 IP주소를 여러 클라이언트에 권고할 수 있으므로 다른 클라이언트가 이미 IP주소를 선점한 경우 `NACK 메시지`를 보내 이 주소가 사용할 수 없음을 클라이언트에게 알리고, 클라이언트가 `DISCOVER` 과정을 다시 진행하도록 한다.

        <br>

    ![Desktop View](/assets/img/Com-Net/69.png)

    ![Desktop View](/assets/img/Com-Net/70.png)

    <br>

### **이동 IP용어**

![Desktop View](/assets/img/Com-Net/71.jpg)

